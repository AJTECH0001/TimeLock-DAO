import { Tx } from "../Tx"

describe("Tx.fromCbor", () => {

    test("parses simple IO tx", () => {

        expect(
            () => 
            Tx.fromCbor(
                "84a30081825820d11531780938f9fc6110c968b8cd571c3b88aa8981bb52c296090958fe27848f000182825839000456f170a8ee5d0fb93458a394ba3a4d043db096e58c8a1f33a6681dcb15713c952715df00f231200e7a208ddeb718d05fcd34c5f0bfdb801b00000045d952e577825839000456f170a8ee5d0fb93458a394ba3a4d043db096e58c8a1f33a6681dcb15713c952715df00f231200e7a208ddeb718d05fcd34c5f0bfdb801a000f4240021a00029049a0f5f6"
            ).toJson(),
        ).not.toThrow();

    });

    test("parses tx with plutus minting policy", () => {

        expect(
            () => 
            Tx.fromCbor(
                "84a600818258203ec172510007430a2acf65d1641689d55255e8aa8fa2800482d64aa2bb88caf4000d818258203ec172510007430a2acf65d1641689d55255e8aa8fa2800482d64aa2bb88caf4000182a2005839003a7a52bdf7c9445db07d902333ec5ba94cf012bf8a6586a606824ed37b1f87071222670a5d7504b843fe4038cd677bba7184ce12ca39f7a2011b00000045d9436e39a2005839003a7a52bdf7c9445db07d902333ec5ba94cf012bf8a6586a606824ed37b1f87071222670a5d7504b843fe4038cd677bba7184ce12ca39f7a201821a001e8480a1581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ea145544f4b454e1a3b9aca00021a0002c54709a1581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ea145544f4b454e1a3b9aca000b58204a9be8ef04017d85557512c3b40097344dc0dc3c58a3beaf0cd5ea772f643e95a2068147460100002249810581840100a246636f6e73747200466669656c647380821903201a0002754cf5f6"
            ).toJson(),
        ).not.toThrow();

    })

    test("tx with inline output datum", () => {

        expect(
            () => 
            Tx.fromCbor(
                "84a60081825820ef42c5fc55e62b32c3dd8e9c5c7692739d9a03d1cf6a329bb4ad5f03f49e2bbc000d81825820ef42c5fc55e62b32c3dd8e9c5c7692739d9a03d1cf6a329bb4ad5f03f49e2bbc000182a2005839004aceb8c360f356bc917b5c547ac4a72cdc6bd2d12a9138b96c9c8999951ee8b677ad1ad65cf38fa2cacd3564a5e2bdcb72405543b4fca9a7011b00000045d8df9874a300583900a9f0f6cb792035f3b50017a52a19c22715d8bc77223e9387236e8e62e38ebe88236fc97a21c1706403e8ff268d36fa961edaa248d840141e01821a001e8480a1581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ea145544f4b454e1a3b9aca00028201d81846d8799f182aff021a0002c4ef09a1581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ea145544f4b454e1a3b9aca000b5820508715c133b784a7a2a4a9cfe2b6f6dd115485d93b4f6fa284ff599549fe0c4ea2068147460100002249810581840100d87980821903201a0002754cf5f6"
            ).toJson()
        ).not.toThrow();
    });

    test("with some strange addr", () => {

        let tx!: Tx;
        expect(
            () => 
            tx = Tx.fromCbor(
                "84a30081825820e47b802209000d3bb27699429e2d763542f0b81ebdeacedadba79ddb3896ebdd040182a200583900da6512c7ff34f5dcd80fe65d4aedbe37ed256361efefb9ee541baac46ba0c056f51cd34c5fe60afe5e480047e73d2e30fe0ea44747e4b8f4011b00000001291d9f53a300581d703d1eaeb1eec9f2f7e185c82681398ca81d9b14a3655ccafb2aa2009b011a00e4e1c003d81859052d8202590528590525010000323232323232323232323232323232323232323232323232323232222533357346664446602c0024646466603800a466034006464660206e3ccc0700248c8004dd71aba10010013300c75c6eb0c07c0048c8c8c8cc0740288c8c8c8c8c8c8c8c8c8cc09c0408c8c8c8cc0ad4ccd5cd19b87011480004d5d080189aba1357440064646605a00246464660626606266062660626604c9201016100357466ae88d5d1004099813249016200330242330323371e6eb8d55ce800808899198199aba335744002266e1cdd69aab9e3574200290011bab35573c00200426604c921016300357466ae88d5d11aba20071330264901016400330303302d00701423233033357466ae880044cdc79bae35573a6ae840052201003756607800226604c9210165003232330325333573466e1c06120001357426ae880284d5d080511919191981b9981624810168003375e006646666605c03e0020024640026ae840040048c0c124101670013232323303a3303a3303a3303a3001008130010031300100213370e01066012028026266e1ccdc119b80003002375a6466660640164640026ae840040040048c0cd24010166003370401066e00ccc0cc02c06005cccc0cc02c058054dc42400066e04cc00805004ccc01c05004ccdc09980080a80a1980300a80a18179981a8009190009bab3041001303f0023574200266605600e0180166054660606605a00e02a4646466066004464646660720044c464a666ae68cc0e4cdc780d000899981d8019181d9919b8735573a6ea8005200001a23233303d01b24a046466607e0064c4646660820024c46466e3c004014dd71aba1001357420026eb8d5d08009aba1001100616375c6ae84004c100008d5d08009bab303d0023574200260720046eacc0e4004c0dc004dd598190019bac303300237586ae84004dd718150049bae302a008375c605400e6eb8c0a8018dd718150029bae302a004375c605400660540046eb8d5d08009bad3026003375a604c0046eb4d5d080098118011aba10010030020011498588cc0080052f5884600446ae80c00800488cc02884008888cc014008c00c0048cc020852891119802980200109801800912999ab9a00214a200244a666ae68004528899ab9c0024a04444464664a666ae68c005200010031533357346002900108020a999ab9a300148010401454ccd5cd1800a400c200c2c6e1cd55ce8009aab9e001375400a444464664a666ae68c005200010031533357346002900108020a999ab9a300148010401458dc39aab9d00135573c0026ea801094cd5ce0008b11119980210a4000444a666ae68cdc79bae35573a00400a266600e4290001112999ab9a3371e6eb8d55ce80100389bad35573c004260060026eacd55cf00109801800801980191111919980318020009801800801198020018011112999aab9f001003133002357420026ae88004c0048894ccd5cd198029aba30023371000290000b0a999ab9a3370e900000089aba10021330033574400466e01200100123230022330020020012300223300200200122333573400494400488c004d55cf1baa002225333573400400229408ccd5cd000a504a244464664a666ae68c005200010031533357346002900108020b1b8735573a0026aae78004dd500191aba1357446ae88d5d11aba2357446ae88d5d11aba20012357426ae88d5d11aba2357446ae88d5d11aba20012357426ae88d5d11aba2357446ae88d5d100091aba1357446ae88d5d11aba23574400246ae84d5d11aba2357446ae880048d5d09aba2357446ae880048d5d09aba23574400246ae84d5d100081021a000370eda0f5f6"
            )
        ).not.toThrow();

    });

    test.only("some cbors", () => {

        expect(
            "84a700828258200d1b39a4fd8bbb74f63f9f3b517a00785cfd7ef093255a1bfcac2d2e631c246a018258201d7b047d4d9e128a91f32436263aaf59ab3d308e079faf1df46f6d5419b6c96e010d81825820145216947102eacf614fa5b4aec1f14775954066962026bea1f53682e17919c2001281825820145216947102eacf614fa5b4aec1f14775954066962026bea1f53682e17919c2010183a2005839009d2f681111cae3c834c026914e77856a793fc0f50bda433065600c9b82356e150de5ff1e15832e21a8b8b46dff3953169238b50eaa4a1a64011a010d5b62a2005839009d2f681111cae3c834c026914e77856a793fc0f50bda433065600c9b82356e150de5ff1e15832e21a8b8b46dff3953169238b50eaa4a1a6401821a001e8480a1581cb3cfb0cb87d88b87a30f9966bf41e8efc61f8faf7c213a1b37e0edefa1426c711a001e8480a3005839108454efe7c7f88563e17322b361750f21c1df91e1a42477f325c97f9e82356e150de5ff1e15832e21a8b8b46dff3953169238b50eaa4a1a6401821a004c4b40a3581c0462de27174c88689ec9fe0e13777e1ed52285510300796e16b88acfa141591a000f4241581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ea141581a000f4241581ce15d8a86a0cfd5fa9152431c91924fa4bb12e98e9a49a2940dc1dceba142494401028201d818451a001e8482021a00054d1e09a1581cb3cfb0cb87d88b87a30f9966bf41e8efc61f8faf7c213a1b37e0edefa1426c711a001e84800b5820b4ee5c4f3796d9e47c05b2c351194aebb6546793dc4bf8979e1cf0d3af33a52ba206825905c75905c401000032323232323232323232323232323232323232323222253335734666666666666444444444444660380024646464666660280040020024646604400a46464646604c01846464646464660586605a01200a46464660566604e9210131003375e01c00426604e92101320032323303100223232323303500723232323232323232323303b3303b3303b3303749010133003303f00d2323304100b23233303800323233303a0032323371e0060026eb8d5d08009250375c6ae840049281aba10013574200226606e9210134003001008133037491013500300100c133037491013600323233303601623303e3371266608042900011119b8048008c00c0040752004132323232323233044330443370e66e08018008cdc100180089919822998008030088998008028081119b873370400400866e0800c0044c8cccc0fc0548c8cdc39bad0013370000c0126ae8400400400498cdc000200199b8000e00d375a05866e0402402ccdc080480599981f80e8168161191981f9981f1981f9981da490137003375e01e66e9520043357400540742660769210138003303f357466ae880784cdc79bae35573a6ae840792210013303b49010139003574603c2660769201046d6174680033712a666ae68cdc4800a400026600601666e00028cdc199b8200702c4820225e84cc00ccdc000599b833370400c058904044bd005198018048041bad357420024464a666ae68cdc38018010800899822911919192999ab9a33041004001100113005001330023370066e08020014cdc1000a400866e00cdc119b810084800800ccdc1000a400c660026600200466e0801920043370400a900211b833370400400203266e00008004cdc1013a400846607246607866e3cdd71aab9d0010301323303d357466ae880044cdc39bad35573c6ae84005200237566aae78004004ccc0e80340b00acccc0e40300a40a0ccc0e00200a009cccc0dc01c0a40a0ccc0d8008098094ccc0d400409c098dd5981f8011aba1001303a003375660760046ae84004cc0c0cc0c40340208c8cc0c80048c8004dd5981d800981c80099818005803181b0011aba10013030005375a605c0086eb4c0bc00cdd698180011bad357420026eacc0a800cdd618150011bac357420026ae840040048c09d2410130003026002357420029111ce15d8a86a0cfd5fa9152431c91924fa4bb12e98e9a49a2940dc1dceb0048811c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466e00488101580048811c0462de27174c88689ec9fe0e13777e1ed52285510300796e16b88acf00488101590048811cb3cfb0cb87d88b87a30f9966bf41e8efc61f8faf7c213a1b37e0edef004881026c7100483c0b920c80100300200114985888888c8cc94ccd5cd1800a400020062a666ae68c005200210041533357346002900208028a999ab9a300148018401858dc39aab9d00135573c0026ea8014888c8cc94ccd5cd1800a400020062a666ae68c0052002100416370e6aae74004d55cf0009baa003222232332533357346002900008018a999ab9a300148008401054ccd5cd1800a4008200a2c6e1cd55ce8009aab9e00137540086ec526225333573400229444cd5ce001250223233006337120029001099b8948004004cdc080100091980290a512223300530040021300300122533357340042944004894ccd5cd0010008a5022233300421480008894ccd5cd19b8f375c6aae740080144ccc01c8520002225333573466e3cdd71aab9d0020071375a6aae780084c00c004dd59aab9e002130030010033004222232333006300400130030010023300400300222253335573e0020062660046ae84004d5d10009118009aab9e37540046002444a666ae68cc014d5d180119b88001480005854ccd5cd19b87480000044d5d08010998019aba200233700900080091918011198010010009180111980100100091199ab9a0024a200246ae84d5d11aba23574400246ae84d5d11aba2357446ae880048d5d09aba2357440024a66ae70004588d5d09aba20010158fc58fa010000323232323232323232223300400123233006001232330092330090012323300b0012323300e2330143371e6eb8d55ce8008068991980a9aba335744002266e1cdd69aab9e3574200290011bab35573c0020026eacc04c004c044004004dd61aba1001357420029111ce15d8a86a0cfd5fa9152431c91924fa4bb12e98e9a49a2940dc1dceb0022300135573c6ea80088cc008852891119804180200109801800980091111919980398020009801800801198020018011191801119801001000918011198010010009112999aab9f001003133002357420026ae88004894ccd5cd0010a51001225333573400400229408d5d09aba2001010583840000d8799f00010202d87a80ff821a000761f01a092f2a1b840001d8799f000100ff821a000703441a08a2b15784010000821a000111631a013a20c1f5f6"
        ).toEqual(
            "84a700828258200d1b39a4fd8bbb74f63f9f3b517a00785cfd7ef093255a1bfcac2d2e631c246a018258201d7b047d4d9e128a91f32436263aaf59ab3d308e079faf1df46f6d5419b6c96e010183a2005839009d2f681111cae3c834c026914e77856a793fc0f50bda433065600c9b82356e150de5ff1e15832e21a8b8b46dff3953169238b50eaa4a1a6401821a001e8480a1581cb3cfb0cb87d88b87a30f9966bf41e8efc61f8faf7c213a1b37e0edefa1426c711a001e8480a3005839108454efe7c7f88563e17322b361750f21c1df91e1a42477f325c97f9e82356e150de5ff1e15832e21a8b8b46dff3953169238b50eaa4a1a6401821a004c4b40a3581c0462de27174c88689ec9fe0e13777e1ed52285510300796e16b88acfa141591a000f4241581c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466ea141581a000f4241581ce15d8a86a0cfd5fa9152431c91924fa4bb12e98e9a49a2940dc1dceba142494401028201d818451a001e8482a2005839009d2f681111cae3c834c026914e77856a793fc0f50bda433065600c9b82356e150de5ff1e15832e21a8b8b46dff3953169238b50eaa4a1a64011a008cff69021a0085a91709a1581cb3cfb0cb87d88b87a30f9966bf41e8efc61f8faf7c213a1b37e0edefa1426c711a001e84800b58206b0ca3c414f8b4c6ab7b7cb7d2cc501bb98f8c48a3853aaf6eb8fbf1b794466f0d81825820145216947102eacf614fa5b4aec1f14775954066962026bea1f53682e17919c2001281825820145216947102eacf614fa5b4aec1f14775954066962026bea1f53682e17919c201a20583840000d8798500010202d87a80821a00041c0b1a0517fd56840001d87983000100821a000211b91a0273aaec84010000821a000111631a013a3231068282025905c75905c401000032323232323232323232323232323232323232323222253335734666666666666444444444444660380024646464666660280040020024646604400a46464646604c01846464646464660586605a01200a46464660566604e9210131003375e01c00426604e92101320032323303100223232323303500723232323232323232323303b3303b3303b3303749010133003303f00d2323304100b23233303800323233303a0032323371e0060026eb8d5d08009250375c6ae840049281aba10013574200226606e9210134003001008133037491013500300100c133037491013600323233303601623303e3371266608042900011119b8048008c00c0040752004132323232323233044330443370e66e08018008cdc100180089919822998008030088998008028081119b873370400400866e0800c0044c8cccc0fc0548c8cdc39bad0013370000c0126ae8400400400498cdc000200199b8000e00d375a05866e0402402ccdc080480599981f80e8168161191981f9981f1981f9981da490137003375e01e66e9520043357400540742660769210138003303f357466ae880784cdc79bae35573a6ae840792210013303b49010139003574603c2660769201046d6174680033712a666ae68cdc4800a400026600601666e00028cdc199b8200702c4820225e84cc00ccdc000599b833370400c058904044bd005198018048041bad357420024464a666ae68cdc38018010800899822911919192999ab9a33041004001100113005001330023370066e08020014cdc1000a400866e00cdc119b810084800800ccdc1000a400c660026600200466e0801920043370400a900211b833370400400203266e00008004cdc1013a400846607246607866e3cdd71aab9d0010301323303d357466ae880044cdc39bad35573c6ae84005200237566aae78004004ccc0e80340b00acccc0e40300a40a0ccc0e00200a009cccc0dc01c0a40a0ccc0d8008098094ccc0d400409c098dd5981f8011aba1001303a003375660760046ae84004cc0c0cc0c40340208c8cc0c80048c8004dd5981d800981c80099818005803181b0011aba10013030005375a605c0086eb4c0bc00cdd698180011bad357420026eacc0a800cdd618150011bac357420026ae840040048c09d2410130003026002357420029111ce15d8a86a0cfd5fa9152431c91924fa4bb12e98e9a49a2940dc1dceb0048811c919d4c2c9455016289341b1a14dedf697687af31751170d56a31466e00488101580048811c0462de27174c88689ec9fe0e13777e1ed52285510300796e16b88acf00488101590048811cb3cfb0cb87d88b87a30f9966bf41e8efc61f8faf7c213a1b37e0edef004881026c7100483c0b920c80100300200114985888888c8cc94ccd5cd1800a400020062a666ae68c005200210041533357346002900208028a999ab9a300148018401858dc39aab9d00135573c0026ea8014888c8cc94ccd5cd1800a400020062a666ae68c0052002100416370e6aae74004d55cf0009baa003222232332533357346002900008018a999ab9a300148008401054ccd5cd1800a4008200a2c6e1cd55ce8009aab9e00137540086ec526225333573400229444cd5ce001250223233006337120029001099b8948004004cdc080100091980290a512223300530040021300300122533357340042944004894ccd5cd0010008a5022233300421480008894ccd5cd19b8f375c6aae740080144ccc01c8520002225333573466e3cdd71aab9d0020071375a6aae780084c00c004dd59aab9e002130030010033004222232333006300400130030010023300400300222253335573e0020062660046ae84004d5d10009118009aab9e37540046002444a666ae68cc014d5d180119b88001480005854ccd5cd19b87480000044d5d08010998019aba200233700900080091918011198010010009180111980100100091199ab9a0024a200246ae84d5d11aba23574400246ae84d5d11aba2357446ae880048d5d09aba2357440024a66ae70004588d5d09aba200101820258fc58fa010000323232323232323232223300400123233006001232330092330090012323300b0012323300e2330143371e6eb8d55ce8008068991980a9aba335744002266e1cdd69aab9e3574200290011bab35573c0020026eacc04c004c044004004dd61aba1001357420029111ce15d8a86a0cfd5fa9152431c91924fa4bb12e98e9a49a2940dc1dceb0022300135573c6ea80088cc008852891119804180200109801800980091111919980398020009801800801198020018011191801119801001000918011198010010009112999aab9f001003133002357420026ae88004894ccd5cd0010a51001225333573400400229408d5d09aba200101f4f6"
        );

    })

});